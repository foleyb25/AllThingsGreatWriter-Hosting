import{_}from"./ImagePickerModalComponent.d4e77567.js";import{f as U,m as M,h as N,D as $,p as j}from"./missing_img.6e9038d9.js";import{_ as F,I as V,g as p,o as n,c as u,a as o,w as g,v as b,x as B,h as v,y as D,T,l as w,t as x,s as R,u as k,e as q,G as h,r as S,b as A}from"./index.d0de3161.js";import{a as E}from"./aspect_missing_img.27806897.js";const W=V({components:{Cropper:U,CircleStencil:M,Preview:N,DropFile:$,ImagePickerModalComponent:_},setup(){const{error:e,loading:l,writer:t,getProfileImageUrls:y}=R(k()),{updateWriterInfo:I}=k(),{pinia_uploadProfileImage:P}=q(),i=h(!1),d=async r=>{t.value.profileImageUrl=r,i.value=!1},c=async()=>{await I(t)},s=h(),m=h();var a=S({articleSrc:E,profileSrc:j,article:"",profile:"",success:!1,failure:!1,failure_Message:""}),C=S({result:{coordinates:null,image:null}});return{uploadProfileImage:async()=>{if(a.profileSrc!=""&&m.value){const{canvas:r}=m.value.getResult();await r.toBlob(async f=>{await P(f,a.profileSrc,t.value._id)},"image/jpeg")}},setProfileImage:r=>{a.profileSrc=r.path,a.profile=r.name},selectImage:d,onChangeProfile:({coordinates:r,image:f})=>{C.result={coordinates:r,image:f}},saveProfile:c,showModal:i,writer:t,loading:l,error:e,getProfileImageUrls:y,state:C,cropper:s,circleCropper:m,img:a}}}),z={class:"w-full"},G={class:"bg-gray-100 w-full"},H={class:"bg-white p-8 rounded-md shadow-lg"},J=o("h1",{class:"text-2xl font-bold mb-4"},"Edit Profile",-1),K={class:"flex flex-col"},L=o("label",{for:"fullname",class:"font-medium mb-1"},"Full Name",-1),O={class:"flex flex-col"},Q=o("label",{for:"nickname",class:"font-medium mb-1"},"Nickname",-1),X={class:"flex flex-col"},Y=o("label",{for:"bio",class:"font-medium mb-1"},"Bio",-1),Z=["placeholder"],ee={class:"mb-4"},oe={class:"w-[15%] mt-2 rounded-full border-2 border-gray-300 mb-2 overflow-hidden"},le={class:"relative aspect-square"},se=["src"],re={class:"flex flex-col justify-center items-center mt-6"},te={id:"profile-cropper-container",class:"flex justify-center items-center aspect-square h-[500px] mr-2"},ae={key:0,class:"flex justify-center items-center w-full bg-green-300 mt-4 border border-black border-solid rounded"},ie={key:1,class:"flex justify-center items-center w-full bg-red-300 mt-4 border border-black border-solid rounded"};function ne(e,l,t,y,I,P){const i=p("ImagePickerModalComponent"),d=p("cropper"),c=p("DropFile");return n(),u("div",z,[o("div",G,[o("div",H,[J,o("div",K,[L,g(o("input",{id:"fullname",type:"text",class:"border rounded-md py-2 px-3","onUpdate:modelValue":l[0]||(l[0]=s=>e.writer.fullName=s)},null,512),[[b,e.writer.fullName]])]),o("div",O,[Q,g(o("input",{id:"nickname",type:"text",class:"border rounded-md py-2 px-3","onUpdate:modelValue":l[1]||(l[1]=s=>e.writer.nickName=s)},null,512),[[b,e.writer.nickName]])]),o("div",X,[Y,g(o("textarea",{id:"bio",rows:"3",class:"border rounded-md py-2 px-3",placeholder:e.writer.bio,"onUpdate:modelValue":l[2]||(l[2]=s=>e.writer.bio=s)},null,8,Z),[[b,e.writer.bio]])]),o("div",ee,[o("div",oe,[o("div",le,[o("img",{class:"bg-cover w-full h-full object-cover",src:e.writer.profileImageUrl,alt:""},null,8,se)])]),o("input",{type:"file",onClick:l[3]||(l[3]=B(s=>e.showModal=!0,["prevent"]))})]),o("button",{type:"submit",onClick:l[4]||(l[4]=(...s)=>e.saveProfile&&e.saveProfile(...s)),class:"bg-blue-500 text-white rounded-md py-2 px-4 hover:bg-blue-600"}," Save ")]),v(T,{name:"fade",appear:""},{default:D(()=>[e.showModal?(n(),A(i,{key:0,imageUrls:e.getProfileImageUrls,"onUpdate:imageUrls":l[5]||(l[5]=s=>e.getProfileImageUrls=s),onCloseModal:l[6]||(l[6]=s=>e.showModal=!1),onSelectImage:e.selectImage},null,8,["imageUrls","onSelectImage"])):w("",!0)]),_:1}),o("div",re,[o("div",te,[v(d,{ref:"circleCropper",src:e.img.profileSrc,onChange:e.onChangeProfile,"stencil-component":e.$options.components.CircleStencil,"stencil-props":{aspectRatio:1/1},"resize-image":{adjustStencil:!1},class:"h-full w-full"},null,8,["src","onChange","stencil-component"])]),v(c,{onFileSelected:e.setProfileImage,class:"mt-8"},null,8,["onFileSelected"]),e.img.success?(n(),u("div",ae," Successfully uploaded image ")):w("",!0),e.img.failure?(n(),u("div",ie," Failed: "+x(e.img.failure_Message),1)):w("",!0),o("button",{class:"w-24 h-12 bg-blue-300 border-solid border-black border rounded mt-4",onClick:l[7]||(l[7]=(...s)=>e.uploadProfileImage&&e.uploadProfileImage(...s))}," Upload ")])])])}const be=F(W,[["render",ne]]);export{be as default};
