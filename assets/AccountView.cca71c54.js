import{_ as M}from"./ImagePickerModalComponent.5f3035bc.js";import{f as U,m as N,h as j,D as V,p as $}from"./missing_img.4a0c4f43.js";import{_ as F,I as B,g as p,o as n,c as u,a as o,w as g,v as b,x as D,j as T,t as C,h as v,y as x,T as R,k as w,s as q,u as S,e as A,G as h,r as _,b as E}from"./index.c69d72d9.js";import{a as W}from"./aspect_missing_img.27806897.js";const z=B({components:{Cropper:U,CircleStencil:N,Preview:j,DropFile:V,ImagePickerModalComponent:M},setup(){const{error:e,loading:l,writer:t,getProfileImageUrls:y}=q(S()),{updateWriterInfo:I}=S(),{pinia_uploadProfileImage:P}=A(),i=h(!1),d=async r=>{t.value.profileImageUrl=r,i.value=!1},c=async()=>{await I(t)},s=h(),m=h();var a=_({articleSrc:W,profileSrc:$,article:"",profile:"",success:!1,failure:!1,failure_Message:""}),k=_({result:{coordinates:null,image:null}});return{uploadProfileImage:async()=>{if(a.profileSrc!=""&&m.value){const{canvas:r}=m.value.getResult();await r.toBlob(async f=>{await P(f,a.profileSrc,t.value._id)},"image/jpeg")}},setProfileImage:r=>{console.log("Setting profile image"),a.profileSrc=r.path,a.profile=r.name},selectImage:d,onChangeProfile:({coordinates:r,image:f})=>{k.result={coordinates:r,image:f}},saveProfile:c,showModal:i,writer:t,loading:l,error:e,getProfileImageUrls:y,state:k,cropper:s,circleCropper:m,img:a}}}),G={class:"w-full"},H={class:"bg-gray-100 w-full"},J={class:"bg-white p-8 rounded-md shadow-lg"},K=o("h1",{class:"text-2xl font-bold mb-4"},"Edit Profile",-1),L={class:"flex flex-col"},O=o("label",{for:"fullname",class:"font-medium mb-1"},"Full Name",-1),Q={class:"flex flex-col"},X=o("label",{for:"nickname",class:"font-medium mb-1"},"Nickname",-1),Y={class:"flex flex-col"},Z=o("label",{for:"bio",class:"font-medium mb-1"},"Bio",-1),ee=["placeholder"],oe={class:"mb-4"},le={class:"w-[15%] mt-2 rounded-full border-2 border-gray-300 mb-2 overflow-hidden"},se={class:"relative aspect-square"},re=["src"],te={class:"flex flex-col justify-center items-center mt-6"},ae={id:"profile-cropper-container",class:"flex justify-center items-center aspect-square h-[500px] mr-2"},ie={key:0,class:"flex justify-center items-center w-full bg-green-300 mt-4 border border-black border-solid rounded"},ne={key:1,class:"flex justify-center items-center w-full bg-red-300 mt-4 border border-black border-solid rounded"};function de(e,l,t,y,I,P){const i=p("ImagePickerModalComponent"),d=p("cropper"),c=p("DropFile");return n(),u("div",G,[o("div",H,[o("div",J,[K,o("div",L,[O,g(o("input",{id:"fullname",type:"text",class:"border rounded-md py-2 px-3","onUpdate:modelValue":l[0]||(l[0]=s=>e.writer.fullName=s)},null,512),[[b,e.writer.fullName]])]),o("div",Q,[X,g(o("input",{id:"nickname",type:"text",class:"border rounded-md py-2 px-3","onUpdate:modelValue":l[1]||(l[1]=s=>e.writer.nickName=s)},null,512),[[b,e.writer.nickName]])]),o("div",Y,[Z,g(o("textarea",{id:"bio",rows:"3",class:"border rounded-md py-2 px-3",placeholder:e.writer.bio,"onUpdate:modelValue":l[2]||(l[2]=s=>e.writer.bio=s)},null,8,ee),[[b,e.writer.bio]])]),o("div",oe,[o("div",le,[o("div",se,[o("img",{class:"bg-cover w-full h-full object-cover",src:e.writer.profileImageUrl,alt:""},null,8,re)])]),o("input",{type:"file",onClick:l[3]||(l[3]=D(s=>e.showModal=!0,["prevent"]))})]),T(" "+C(e.showModal)+" ",1),o("button",{type:"submit",onClick:l[4]||(l[4]=(...s)=>e.saveProfile&&e.saveProfile(...s)),class:"bg-blue-500 text-white rounded-md py-2 px-4 hover:bg-blue-600"}," Save ")]),v(R,{name:"fade",appear:""},{default:x(()=>[e.showModal?(n(),E(i,{key:0,imageUrls:e.getProfileImageUrls,"onUpdate:imageUrls":l[5]||(l[5]=s=>e.getProfileImageUrls=s),onCloseModal:l[6]||(l[6]=s=>e.showModal=!1),onSelectImage:e.selectImage},null,8,["imageUrls","onSelectImage"])):w("",!0)]),_:1}),o("div",te,[o("div",ae,[v(d,{ref:"circleCropper",src:e.img.profileSrc,onChange:e.onChangeProfile,"stencil-component":e.$options.components.CircleStencil,"stencil-props":{aspectRatio:1/1},"resize-image":{adjustStencil:!1},class:"h-full w-full"},null,8,["src","onChange","stencil-component"])]),v(c,{onFileSelected:e.setProfileImage,class:"mt-8"},null,8,["onFileSelected"]),e.img.success?(n(),u("div",ie," Successfully uploaded image ")):w("",!0),e.img.failure?(n(),u("div",ne," Failed: "+C(e.img.failure_Message),1)):w("",!0),o("button",{class:"w-24 h-12 bg-blue-300 border-solid border-black border rounded mt-4",onClick:l[7]||(l[7]=(...s)=>e.uploadProfileImage&&e.uploadProfileImage(...s))}," Upload ")])])])}const ve=F(z,[["render",de]]);export{ve as default};
