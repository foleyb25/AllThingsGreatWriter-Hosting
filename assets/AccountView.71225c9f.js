import{_ as S}from"./ImagePickerModalComponent.4f6f062a.js";import{f as U,m as M,h as N,D as j}from"./DropFile.7fb4b8ae.js";import{_ as $,I as F,g as p,o as n,c as u,a as o,w as g,v as b,x as V,h as v,y as B,T as D,k as w,t as T,s as x,u as C,e as R,G as h,r as _,b as q}from"./index.533ef80a.js";import{a as A}from"./aspect_missing_img.27806897.js";const E="/assets/missing_img.f71b01d1.jpeg",W=F({components:{Cropper:U,CircleStencil:M,Preview:N,DropFile:j,ImagePickerModalComponent:S},setup(){const{error:e,loading:s,writer:t,getProfileImageUrls:y}=x(C()),{updateWriterInfo:I}=C(),{pinia_uploadProfileImage:P}=R(),a=h(!1),d=async r=>{t.value.profileImageUrl=r,a.value=!1},c=async()=>{await I(t)},l=h(),m=h();var i=_({articleSrc:A,profileSrc:E,article:"",profile:"",success:!1,failure:!1,failure_Message:""}),k=_({result:{coordinates:null,image:null}});return{uploadProfileImage:async()=>{if(i.profileSrc!=""&&m.value){const{canvas:r}=m.value.getResult();await r.toBlob(async f=>{await P(f,i.profileSrc,t.value._id)},"image/jpeg")}},setProfileImage:r=>{i.profileSrc=r.path,i.profile=r.name},selectImage:d,onChangeProfile:({coordinates:r,image:f})=>{k.result={coordinates:r,image:f}},saveProfile:c,showModal:a,writer:t,loading:s,error:e,getProfileImageUrls:y,state:k,cropper:l,circleCropper:m,img:i}}}),z={class:"w-full"},G={class:"bg-gray-100 w-full"},H={class:"bg-white p-8 rounded-md shadow-lg"},J=o("h1",{class:"text-2xl font-bold mb-4"},"Edit Profile",-1),K={class:"flex flex-col"},L=o("label",{for:"fullname",class:"font-medium mb-1"},"Full Name",-1),O={class:"flex flex-col"},Q=o("label",{for:"nickname",class:"font-medium mb-1"},"Nickname",-1),X={class:"flex flex-col"},Y=o("label",{for:"bio",class:"font-medium mb-1"},"Bio",-1),Z=["placeholder"],ee={class:"mb-4"},oe={class:"w-[15%] mt-2 rounded-full border-2 border-gray-300 mb-2 overflow-hidden"},se={class:"relative aspect-square"},le=["src"],re={class:"flex flex-col justify-center items-center mt-6"},te={id:"profile-cropper-container",class:"flex justify-center items-center aspect-square h-[500px] mr-2"},ie={key:0,class:"flex justify-center items-center w-full bg-green-300 mt-4 border border-black border-solid rounded"},ae={key:1,class:"flex justify-center items-center w-full bg-red-300 mt-4 border border-black border-solid rounded"};function ne(e,s,t,y,I,P){const a=p("ImagePickerModalComponent"),d=p("cropper"),c=p("DropFile");return n(),u("div",z,[o("div",G,[o("div",H,[J,o("div",K,[L,g(o("input",{id:"fullname",type:"text",class:"border rounded-md py-2 px-3","onUpdate:modelValue":s[0]||(s[0]=l=>e.writer.fullName=l)},null,512),[[b,e.writer.fullName]])]),o("div",O,[Q,g(o("input",{id:"nickname",type:"text",class:"border rounded-md py-2 px-3","onUpdate:modelValue":s[1]||(s[1]=l=>e.writer.nickName=l)},null,512),[[b,e.writer.nickName]])]),o("div",X,[Y,g(o("textarea",{id:"bio",rows:"3",class:"border rounded-md py-2 px-3",placeholder:e.writer.bio,"onUpdate:modelValue":s[2]||(s[2]=l=>e.writer.bio=l)},null,8,Z),[[b,e.writer.bio]])]),o("div",ee,[o("div",oe,[o("div",se,[o("img",{class:"bg-cover w-full h-full object-cover",src:e.writer.profileImageUrl,alt:""},null,8,le)])]),o("input",{type:"file",onClick:s[3]||(s[3]=V(l=>e.showModal=!0,["prevent"]))})]),o("button",{type:"submit",onClick:s[4]||(s[4]=(...l)=>e.saveProfile&&e.saveProfile(...l)),class:"bg-blue-500 text-white rounded-md py-2 px-4 hover:bg-blue-600"}," Save ")]),v(D,{name:"fade",appear:""},{default:B(()=>[e.showModal?(n(),q(a,{key:0,imageUrls:e.getProfileImageUrls,"onUpdate:imageUrls":s[5]||(s[5]=l=>e.getProfileImageUrls=l),onCloseModal:s[6]||(s[6]=l=>e.showModal=!1),onSelectImage:e.selectImage},null,8,["imageUrls","onSelectImage"])):w("",!0)]),_:1}),o("div",re,[o("div",te,[v(d,{ref:"circleCropper",src:e.img.profileSrc,onChange:e.onChangeProfile,"stencil-component":e.$options.components.CircleStencil,"stencil-props":{aspectRatio:1/1},"resize-image":{adjustStencil:!1},class:"h-full w-full"},null,8,["src","onChange","stencil-component"])]),v(c,{onFileSelected:e.setProfileImage,class:"mt-8"},null,8,["onFileSelected"]),e.img.success?(n(),u("div",ie," Successfully uploaded image ")):w("",!0),e.img.failure?(n(),u("div",ae," Failed: "+T(e.img.failure_Message),1)):w("",!0),o("button",{class:"w-24 h-12 bg-blue-300 border-solid border-black border rounded mt-4",onClick:s[7]||(s[7]=(...l)=>e.uploadProfileImage&&e.uploadProfileImage(...l))}," Upload ")])])])}const be=$(W,[["render",ne]]);export{be as default};
